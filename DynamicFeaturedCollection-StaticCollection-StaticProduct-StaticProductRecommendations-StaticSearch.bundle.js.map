{"version":3,"sources":["webpack:///./source/scripts/Layout.js","webpack:///./source/scripts/helpers/Quantity.js","webpack:///./source/scripts/Forms.js","webpack:///./source/scripts/components/RichText.js","webpack:///./source/scripts/helpers/scrollLeft.js","webpack:///./source/scripts/components/MessageBanner.js","webpack:///./source/scripts/components/Youtube.js","webpack:///./source/scripts/components/Vimeo.js","webpack:///./source/scripts/components/Video.js","webpack:///./source/scripts/ProductOptions.js","webpack:///./source/scripts/VariantHelper.js","webpack:///./source/scripts/helpers/flickityHelper.js","webpack:///./source/scripts/components/ProductZoom.js","webpack:///./source/scripts/components/ProductGallery.js","webpack:///./source/scripts/components/ProductDetails.js","webpack:///./source/scripts/helpers/Images.js","webpack:///./source/scripts/components/AddToCartFlyout.js"],"names":["eventHandlers","previousBreakpoint","getBreakpoint","window","getComputedStyle","document","documentElement","getPropertyValue","replace","$","on","event","currentBreakpoint","forEach","eventHandler","previous","current","isBreakpoint","breakpoint","onBreakpointChange","indexOf","push","offBreakpointChange","index","splice","Quantity","el","$el","$inputParent","find","$input","$selectParent","$select","_watchSelect","bind","_watchInput","off","baseValue","parseInt","currentTarget","value","isNaN","_validateValue","val","trigger","removeClass","addClass","focus","removeAttr","select","attr","Forms","selector","filledClass","fieldSelector","quantityItems","$quantityWrapper","_toggleFilled","_checkFilled","length","each","i","quantityItem","unload","hasClass","target","$target","isFilled","is","toggleClass","e","RichText","_initExternalLinks","groupedContent","GroupedContent","get","layout","intelliparse","fitvids","anchors","filter","href","location","hostname","scrollLeft","$container","parent","animate","offset","left","width","MessageBanner","$window","$document","$body","body","$bannerTemplate","$banners","header","querySelector","events","_handleDocumentClick","_closeEsc","message","type","$banner","clone","html","append","_bindEvents","_show","$visibleBanners","banner","_hide","preventDefault","key","dismissBanners","one","_removeBanner","remove","$parent","parents","api","apiLoadedCallbacks","apiLoaded","onYouTubeIframeAPIReady","apiLoadedCallback","Youtube","videoUrl","regex","id","match","onApiLoaded","_onApiLoaded","isReady","onReady","_onReady","onReadyCallback","onStateChange","_onStateChange","onPlayCallback","$script","Promise","resolve","player","playVideo","pauseVideo","mute","destroy","YT","Player","videoId","playerVars","modestbranding","showinfo","controls","rel","state","data","PlayerState","BUFFERING","VimeoPlayer","urlParts","split","onProgress","_onProgress","onProgressCallback","play","pause","setVolume","catch","Vimeo","ready","then","Video","options","platform","getAttribute","trim","playButton","videoEl","onPlayClick","_onPlayClick","onPauseClick","_onPauseClick","autoplay","_autoplay","video","videoData","childNodes","addEventListener","classList","add","setTimeout","removeEventListener","Node","variant","optionsCount","neighbors","variants","item","option","available","ProductOptions","product","productHandle","handle","nodeMap","_generateNodeMap","variant2","addNeighbor","foundVariant","found","closestVariant","matchingValues","tempMatchingValues","getVariantFromOptions","getClosestVariantFromOptions","getValidOptions","VariantHelper","$variants","$options","productOptions","optionsTypes","radio","optionsType","console","warn","_unbindEvents","_switchVariant","firstLoad","$selected","availableOptions","getVariantOrClosestFromOptions","getAvailableOptionsFromVariant","_switchVariantSelect","_switchVariantRadio","$optionEls","$option","prop","encodeURIComponent","char","charCodeAt","toString","toUpperCase","title","option1","resizeFlickityIfNeeded","flickity","activeHeight","selectedElement","offsetHeight","flickityHeight","viewport","resize","ProductZoom","$gallery","settings","$slider","$pixelzoomOverlay","$pixelzoomOverlayContainer","imageZoom","zoomOverlay","_beforeOpen","_onOpen","_onClose","_showZoomInstructions","modalOpen","swipping","touched","enableZoom","Object","keys","image","passive","$newSlide","inObject","slideExists","Pixelzoom","imageSource","dataset","initialZoom","image_zoom_level","zoomSensitivity","maxZoom","zoomSteps","naturalPan","imageWidth","naturalWidth","imageHeight","naturalHeight","height","_toggleClass","css","_preventClick","_resolveClick","_preventScroll","element","className","replaceWith","dragPan","overflowContainer","ProductGallery","isQuickshop","slider","slides","$slides","$sliderPagination","$paginationTrigger","productZoom","enable_image_zoom","videos","videoSlides","querySelectorAll","_onUpdateGallery","slideImageLoaded","_onSlideImageLoaded","variantChange","_onVariantChange","_init","_unloadGallery","videoSlide","slideId","_initGallery","fullscreenElement","featured_image","$selectedImage","flickityOptions","autoPlay","accessibility","adaptiveHeight","cellAlign","cellSelector","pageDots","prevNextButtons","wrapAround","optionsMobile","draggable","friction","selectedAttraction","optionsDesktop","extend","initialIndex","Flickity","_bindGallery","_handleGalleryVideos","_updateActiveSlide","selectedIndex","videoKey","enable_video_autoplay","$newThumbnail","siblings","ProductDetails","$formArea","$details","context","useHistory","variantHelper","atcCallbacks","$form","$productAtcButton","$productVariants","$productOptions","variantFields","$price","$priceMoney","$compareAtPrice","$compareAtPriceMoney","$badge","$badgeMoneySaved","$badgePercentSaved","$sku","forms","gallery","_initOptions","_AddToCartFlyout","_updatePrice","_updateSKU","_updateBadge","_updateButton","url","param","history","replaceState","hasComparePrice","compare_at_price","price","text","Shopify","formatMoney","money_format","CurrencyConverter","update","sku","priceSaved","toggle","percentileSaved","Math","round","product_available","product_unavailable","formData","serializeArray","$atcButton","moneyFormat","cartRedirection","cart_redirection","AddToCartFlyout","init","Images","images","size","imageArray","loadImage","getSizedImageUrl","path","Image","src","removeProtocol","prefix","suffix","flyOutSelector","$atcTemplate","activeElement","itemId","atcFlyOut","_onInit","_onError","_onSuccess","_onCloseAll","messageBanner","headerAnnouncement","$header","callbacks","onInit","onError","onSuccess","onClose","_closeFlyOuts","_disableButton","_updateCart","_removeFlyOuts","$flyOut","quantityField","name","quantity","ajax","dataType","done","response","imageUrl","product_title","variant_options","join","$productPriceQuantity","secondResponse","lineItem","items","line_level_discount_allocations","concat","final_price","$productPriceValue","original_price","$productPriceDiscounted","show","hide","$productDiscounts","discountItemTemplate","children","first","empty","discount","$listItem","discount_application","$amount","amount","$subTotal","total_price","item_count","_openFlyOut","fail","errorText","responseText","JSON","parse","description","error","status","statusText","_enableButton","_closeFlyOut","$excludeFlyOut","trapFocus","_removeFlyOut","documentClickEventTarget","removeTrapFocus"],"mappings":"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","file":"DynamicFeaturedCollection-StaticCollection-StaticProduct-StaticProductRecommendations-StaticSearch.bundle.js","sourcesContent":["import $ from 'jquery';\n\nconst eventHandlers = [];\nlet previousBreakpoint = null;\n\nfunction getBreakpoint() {\n  return window\n    .getComputedStyle(document.documentElement, ':after')\n    .getPropertyValue('content')\n    .replace(/\"/g, '');\n}\n\n$(window).on('resize', event => {\n  const currentBreakpoint = getBreakpoint();\n\n  if (previousBreakpoint !== currentBreakpoint) {\n    eventHandlers.forEach(eventHandler => {\n      eventHandler(event, {\n        previous: previousBreakpoint,\n        current: currentBreakpoint,\n      });\n    });\n  }\n\n  previousBreakpoint = currentBreakpoint;\n});\n\nfunction isBreakpoint(breakpoint) {\n  return getBreakpoint() === breakpoint;\n}\n\nfunction onBreakpointChange(eventHandler) {\n  if (eventHandlers.indexOf(eventHandler) === -1) {\n    eventHandlers.push(eventHandler);\n  }\n}\n\nfunction offBreakpointChange(eventHandler) {\n  const index = eventHandlers.indexOf(eventHandler);\n\n  if (index !== -1) {\n    eventHandlers.splice(index, 1);\n  }\n}\n\nexport default {\n  isBreakpoint,\n  onBreakpointChange,\n  offBreakpointChange,\n};\n","export default class Quantity {\n  constructor(el) {\n    this.$el = $(el);\n    this.$inputParent = this.$el.find('.form-field--qty-input');\n    this.$input = this.$el.find('[data-quantity-input]');\n    this.$selectParent = this.$el.find('.form-field--qty-select');\n    this.$select = this.$el.find('[data-quantity-select]');\n\n    this._watchSelect = this._watchSelect.bind(this);\n    this._watchInput = this._watchInput.bind(this);\n\n    this.$select.on('change.quantity', this._watchSelect);\n    this.$input.on('change.quantity', this._watchInput);\n  }\n\n  unload() {\n    this.$el.off('.quantity');\n  }\n\n  _validateValue(event) {\n    const baseValue = parseInt(event.currentTarget.value, 10);\n\n    return isNaN(baseValue) ? 1 : baseValue;\n  }\n\n  _watchSelect(event) {\n    const value = this._validateValue(event);\n\n    // Update input to match select\n    this.$input.val(value).trigger('change');\n\n    // Switch to quantity input when 10 or more\n    if (value >= 10) {\n      this.$inputParent\n        .removeClass('hidden')\n        .addClass('visible');\n\n      this.$input\n        .focus()\n        .removeAttr('tabindex')\n        .select();\n\n      this.$selectParent\n        .removeClass('visible')\n        .addClass('hidden');\n\n      this.$select.attr('tabindex', '-1');\n    }\n  }\n\n  _watchInput(event) {\n    this.$input.val(this._validateValue(event));\n  }\n}\n","import $ from 'jquery';\nimport Quantity from './helpers/Quantity';\n\nexport default class Forms {\n  constructor($el, selector = '.form-field-input') {\n    this.$el = $el;\n    this.filledClass = 'form-field-filled';\n    this.fieldSelector = selector;\n\n    this.quantityItems = [];\n    this.$quantityWrapper = this.$el.find('[data-quantity-wrapper]');\n\n    this._toggleFilled = this._toggleFilled.bind(this);\n    this.$el.on('focus.forms', this.fieldSelector, this._toggleFilled);\n    this.$el.on('blur.forms', this.fieldSelector, this._toggleFilled);\n\n    this._checkFilled();\n\n    if (this.$quantityWrapper.length) {\n      this.$quantityWrapper.each((i, el) => {\n        this.quantityItems.push(\n          new Quantity(el),\n        );\n      });\n    }\n  }\n\n  unload() {\n    this.$el.off('.forms');\n\n    this.quantityItems.forEach(quantityItem => {\n      quantityItem.unload();\n    });\n  }\n\n  _checkFilled() {\n    this.$el.find(this.fieldSelector).each((i, el) => {\n      if ($(el).hasClass(this.filledClass)) return;\n\n      this._toggleFilled(null, el);\n    });\n  }\n\n  _toggleFilled(event = null, el = false) {\n    const target = event ? event.currentTarget : el;\n    const $target = $(target);\n    const { value } = target;\n\n    let isFilled = value.length > 0;\n\n    try {\n      isFilled = isFilled || $target.is(':-webkit-autofill');\n      $target.toggleClass(this.filledClass, isFilled);\n    } catch (e) {\n      $target.toggleClass(this.filledClass, isFilled);\n    }\n  }\n}\n","import fitvids from 'fitvids';\nimport GroupedContent from 'grouped-content';\n\nexport default class RichText {\n  constructor($el) {\n    this.$el = $el;\n    this._initExternalLinks();\n    this.groupedContent = null;\n\n    if (this.$el.length) {\n      this.groupedContent = new GroupedContent($el.get(0), {\n        layout: 'tabs',\n        intelliparse: false,\n      });\n\n      fitvids('.rte');\n    }\n  }\n\n  unload() {\n    if (this.groupedContent) {\n      this.groupedContent.unload();\n    }\n  }\n\n  /**\n   * Open links within an RTE field in a new window if they point to external domains\n   *\n   * @private\n   */\n  _initExternalLinks() {\n    const anchors = this.$el.find('a[href^=\"http\"]').filter((i, el) => el.href.indexOf(location.hostname) === -1);\n    anchors.attr('target', '_blank');\n  }\n}\n","export default function scrollLeft($el) {\n  const $container = $el.parent();\n\n  $container.animate({\n    scrollLeft: $el.offset().left - ($el.width() / 2) - ($container.width() / 2),\n  });\n}\n","import $ from 'jquery';\n\nexport default class MessageBanner {\n  constructor() {\n    this.$window = $(window);\n    this.$document = $(document);\n    this.$body = $(document.body);\n    this.$bannerTemplate = $('[data-templates] [data-message-banner]');\n    this.$banners = [];\n\n    this.header = document.querySelector('[data-site-header]');\n    this.events = [];\n\n    this.$document.on('touchstart.message-banner, click.message-banner', event => {\n      this._handleDocumentClick(event.target);\n    });\n\n    this.$window.on('keydown.message-banner', event => this._closeEsc(event));\n  }\n\n  unload() {\n    this.$document.off('touchstart.message-banner, click.message-banner');\n    this.$window.off('keydown.message-banner');\n  }\n\n  message(message, type) {\n    const $banner = this.$bannerTemplate.clone();\n\n    $banner\n      .addClass(`message--${type}`)\n      .find('[data-message-banner-content]')\n      .html(message);\n\n    $(this.header).append($banner);\n    this._bindEvents($banner);\n    this._show($banner);\n  }\n\n  dismissBanners() {\n    const $visibleBanners = $('[data-message-banner]:visible');\n\n    $visibleBanners.each((index, banner) => {\n      this._hide($(banner), index);\n    });\n  }\n\n  _bindEvents($banner) {\n    this.events.push([\n      $banner.on('click.message-banner', '[data-message-banner-close]', event => {\n        event.preventDefault();\n        this._hide($banner);\n      }),\n      this.$window.on('keydown.message-banner', e => {\n        if (e.key === 'Escape') {\n          this._hide($banner);\n        }\n      }),\n    ]);\n  }\n\n  _closeEsc(e) {\n    if (e.key === 'Escape') {\n      this.dismissBanners();\n    }\n  }\n\n  _show($banner) {\n    this.$banners.push($banner);\n\n    $banner\n      .addClass('animating animating-in')\n      .one('trend', () => {\n        $banner\n          .removeClass('animating animating-in')\n          .addClass('visible')\n          .off('trend');\n      });\n  }\n\n  _hide($banner, index = 0) {\n    $banner\n      .addClass('animating animating-out')\n      .one('trend', () => {\n        $banner\n          .removeClass('animating animating-out visible')\n          .off('trend');\n        this._removeBanner($banner, index);\n      });\n  }\n\n  _removeBanner($banner, index) {\n    if (this.events[index]) {\n      this.events[index].forEach($el => $el.off('.message-banner'));\n      this.events.splice(index, 1);\n    }\n\n    this.$banners.splice(index, 1);\n    $banner.remove();\n  }\n\n  _handleDocumentClick(target) {\n    const $parent = $(target).parents('[data-message-banner]');\n    if ($parent.length) return;\n\n    this.dismissBanners();\n  }\n}\n","import $script from 'scriptjs';\n\nconst api = 'https://www.youtube.com/iframe_api';\nlet apiLoadedCallbacks = [];\nlet apiLoaded = false;\n\nwindow.onYouTubeIframeAPIReady = () => {\n  apiLoadedCallbacks.forEach(apiLoadedCallback => apiLoadedCallback());\n  apiLoadedCallbacks = [];\n  apiLoaded = true;\n};\n\nexport default class Youtube {\n  constructor({ el, videoUrl }) {\n    const regex = /(?:youtube\\.com\\/(?:[^\\/]+\\/.+\\/|(?:v|e(?:mbed)?)\\/|.*[?&]v=)|youtu\\.be\\/)([^\"&?\\/ ]{11})/i; // eslint-disable-line no-useless-escape\n\n    this.el = el;\n    this.id = videoUrl.match(regex)[1] || null;\n\n    this.onApiLoaded = this._onApiLoaded.bind(this);\n\n    this.isReady = false;\n    this.onReady = this._onReady.bind(this);\n    this.onReadyCallback = null;\n\n    this.onStateChange = this._onStateChange.bind(this);\n    this.onPlayCallback = null;\n\n    if (apiLoaded) {\n      this._onApiLoaded();\n    } else {\n      apiLoadedCallbacks.push(this.onApiLoaded);\n      $script(api);\n    }\n  }\n\n  play() {\n    return new Promise(resolve => {\n      this.onPlayCallback = resolve;\n\n      if (this.isReady) {\n        this.player.playVideo();\n      } else {\n        this.onReadyCallback = () => { this.player.playVideo(); };\n      }\n    });\n  }\n\n  pause() {\n    return new Promise(resolve => {\n      this.onPlayCallback = resolve;\n\n      if (this.isReady) {\n        this.player.pauseVideo();\n      } else {\n        this.onReadyCallback = () => { this.player.pauseVideo(); };\n      }\n    });\n  }\n\n  autoplay() {\n    return new Promise(resolve => {\n      this.onPlayCallback = resolve;\n\n      if (this.isReady) {\n        this.player.playVideo();\n        this.player.mute();\n      } else {\n        this.onReadyCallback = () => {\n          this.player.playVideo();\n          this.player.mute();\n        };\n      }\n    });\n  }\n\n  unload() {\n    this.player.destroy();\n  }\n\n  _onApiLoaded() {\n    this.player = new YT.Player(this.el, {\n      videoId: this.id,\n      playerVars: {\n        modestbranding: true,\n        showinfo: false,\n        controls: false,\n        rel: 0,\n      },\n      events: {\n        onReady: this.onReady,\n        onStateChange: this.onStateChange,\n      },\n    });\n  }\n\n  _onReady() {\n    this.isReady = true;\n\n    if (this.onReadyCallback) {\n      this.onReadyCallback();\n    }\n  }\n\n  _onStateChange(event) {\n    const state = event.data;\n    if (\n      this.onPlayCallback\n      && state === YT.PlayerState.BUFFERING\n    ) {\n      this.onPlayCallback();\n      this.onPlayCallback = null;\n    }\n  }\n}\n","import $script from 'scriptjs';\n\nconst api = 'https://player.vimeo.com/api/player.js';\nlet apiLoaded = false;\n\nexport default class VimeoPlayer {\n  constructor({ el, videoUrl }) {\n    this.el = el;\n    const urlParts = videoUrl.split('/');\n\n    this.id = urlParts[urlParts.length - 1];\n    this.onReadyCallback = null;\n\n    this.onApiLoaded = this._onApiLoaded.bind(this);\n\n    this.onProgress = this._onProgress.bind(this);\n    this.onProgressCallback = null;\n\n    if (apiLoaded) {\n      this._onApiLoaded();\n    } else {\n      $script(api, this.onApiLoaded);\n    }\n  }\n\n  play() {\n    return new Promise(resolve => {\n      this.onProgressCallback = resolve;\n\n      if (apiLoaded) {\n        this.player.on('play', this.onProgress);\n        this.player.play();\n      } else {\n        this.onReadyCallback = () => {\n          this.player.on('play', this.onProgress);\n          this.player.play();\n        };\n      }\n    });\n  }\n\n  pause() {\n    return new Promise(resolve => {\n      this.onProgressCallback = resolve;\n\n      if (apiLoaded) {\n        this.player.on('pause', this.onProgress);\n        this.player.pause();\n      } else {\n        this.onReadyCallback = () => {\n          this.player.on('pause', this.onProgress);\n          this.player.pause();\n        };\n      }\n    });\n  }\n\n  autoplay() {\n    return new Promise(resolve => {\n      this.onProgressCallback = resolve;\n\n      if (apiLoaded) {\n        this.player.on('play', this.onProgress);\n        this.player.setVolume(0);\n        this.player.play();\n      } else {\n        this.onReadyCallback = () => {\n          this.player.on('play', this.onProgress);\n          this.player.setVolume(0);\n          this.player.play();\n        };\n      }\n    });\n  }\n\n  unload() {\n    this.player\n      .unload()\n      .catch();\n  }\n\n  _onApiLoaded() {\n    this.player = new window.Vimeo.Player(this.el, { id: this.id });\n\n    this.player\n      .ready()\n      .then()\n      .catch();\n\n    apiLoaded = true;\n\n    if (this.onReadyCallback) {\n      this.onReadyCallback();\n    }\n  }\n\n  _onProgress() {\n    this.player.off('play', this.onProgress);\n    this.player.off('pause', this.onProgress);\n\n    if (this.onProgressCallback) {\n      this.onProgressCallback();\n      this.onProgressCallback = null;\n    }\n  }\n}\n","import Youtube from './Youtube';\nimport Vimeo from './Vimeo';\n\nexport default class Video {\n  constructor(el, options) {\n    this.el = el;\n    this.options = options;\n    this.platform = el.getAttribute('data-video').trim();\n    this.playButton = el.querySelector('[data-video-play-button]');\n    this.videoEl = el.querySelector('[data-video-element]');\n\n    this.onPlayClick = this._onPlayClick.bind(this);\n    this.onPauseClick = this._onPauseClick.bind(this);\n    this.autoplay = this._autoplay.bind(this);\n\n    this.video = null;\n\n    this.videoData = {\n      el: this.videoEl.childNodes[0],\n      videoUrl: this.videoEl.getAttribute('data-video-url'),\n    };\n\n    switch (this.platform) {\n      case 'youtube':\n        this.video = new Youtube(this.videoData);\n        break;\n      case 'vimeo':\n        this.video = new Vimeo(this.videoData);\n        break;\n      default:\n        this.video = null;\n        break;\n    }\n\n    if (this.playButton) {\n      if (this.options && this.options.autoplay) {\n        this.autoplay();\n      }\n\n      this.playButton.addEventListener('click', this.onPlayClick);\n    }\n  }\n\n  _onPlayClick() {\n    this.el.classList.add('video-loading');\n\n    this.video.play()\n      .then(() => {\n        this.el.classList.add('video-transitioning');\n\n        setTimeout(() => {\n          this.el.classList.remove('video-loading');\n          this.el.classList.remove('video-transitioning');\n          this.el.classList.add('video-playing');\n        }, 200);\n      });\n  }\n\n  _onPauseClick() {\n    this.video.pause();\n  }\n\n  _autoplay() {\n    this.el.classList.add('video-loading');\n\n    this.video.autoplay()\n      .then(() => {\n        this.el.classList.add('video-transitioning');\n\n        setTimeout(() => {\n          this.el.classList.remove('video-loading');\n          this.el.classList.remove('video-transitioning');\n          this.el.classList.add('video-playing');\n        }, 200);\n      });\n  }\n\n  unload() {\n    if (this.playButton) {\n      this.playButton.removeEventListener('click', this.onPlayClick);\n    }\n\n    if (this.video) {\n      this.video.unload();\n    }\n  }\n}\n","class Node {\n  constructor(variant) {\n    this.variant = variant;\n    this.optionsCount = this.variant.options.length;\n    this.neighbors = [];\n\n    for (let i = 0; i < this.optionsCount; i++) {\n      this.neighbors.push([]);\n    }\n  }\n\n  addNeighbor(variant) {\n    for (let i = 0; i < this.optionsCount; i++) {\n      if (this.variant.options[i] !== variant.options[i]) {\n        this.neighbors[i].push(variant);\n        break;\n      }\n    }\n  }\n\n  getValidOptions() {\n    const options = [];\n\n    for (let i = 0; i < this.optionsCount; i++) {\n      const variants = [this.variant, ...this.neighbors[i]];\n      options[i] = {};\n\n      variants.forEach(item => {\n        const variant = item;\n        const option = variant.options[i];\n\n        options[i][option] = {\n          available: (options[i][option] && options[i][option].available) || variant.available,\n        };\n      });\n    }\n\n    return options;\n  }\n}\n\nexport default class ProductOptions {\n  constructor(product) {\n    this.productHandle = product.handle;\n    this.optionsCount = product.options.length;\n    this.variants = product.variants;\n    this.nodeMap = {};\n\n    this._generateNodeMap(product);\n  }\n\n  _generateNodeMap() {\n    this.variants.forEach(variant => {\n      this.nodeMap[variant.id] = new Node(variant);\n\n      this.variants.forEach(variant2 => {\n        this.nodeMap[variant.id].addNeighbor(variant2);\n      });\n    });\n  }\n\n  getVariantFromOptions(options) {\n    let foundVariant = false;\n\n    this.variants.forEach(variant => {\n      let found = true;\n\n      for (let i = 0; i < variant.options.length; i++) {\n        if (options[i] !== variant.options[i]) {\n          found = false;\n        }\n      }\n\n      if (found) {\n        foundVariant = variant;\n      }\n    });\n\n    return foundVariant;\n  }\n\n  getClosestVariantFromOptions(options) {\n    let closestVariant = null;\n    let matchingValues = 0;\n\n    this.variants.forEach(variant => {\n      let tempMatchingValues = 0;\n\n      for (let i = 0; i < variant.options.length; i++) {\n        if (options[i] === variant.options[i]) {\n          tempMatchingValues++;\n        } else {\n          break;\n        }\n      }\n\n      if (tempMatchingValues >= matchingValues) {\n        closestVariant = variant;\n        matchingValues = tempMatchingValues;\n      }\n    });\n\n    return closestVariant || false;\n  }\n\n  getVariantOrClosestFromOptions(options) {\n    return this.getVariantFromOptions(options)\n      || this.getClosestVariantFromOptions(options);\n  }\n\n  getAvailableOptionsFromVariant(variant) {\n    return this.nodeMap[variant.id].getValidOptions();\n  }\n}\n","import $ from 'jquery';\nimport ProductOptions from './ProductOptions';\n\nexport default class VariantHelper {\n  constructor(product, $variants, $options) {\n    this.product = product;\n    this.optionsCount = this.product.options.length;\n    this.$variants = $variants;\n    this.$options = $options;\n    this.productOptions = new ProductOptions(this.product);\n    this.optionsTypes = {\n      select: 'select',\n      radio: 'input[type=\"radio\"]',\n    };\n\n    this._bindEvents();\n\n    if (this.$options.is(this.optionsTypes.select)) {\n      this.optionsType = this.optionsTypes.select;\n    } else if (this.$options.is(this.optionsTypes.radio)) {\n      this.optionsType = this.optionsTypes.radio;\n    } else {\n      console.warn('Variant helper: Option set is not a valid type');\n      this._unbindEvents();\n    }\n\n    this._switchVariant(null, true);\n  }\n\n  _bindEvents() {\n    this.$options.on('change.variant-helper', event => this._switchVariant(event));\n  }\n\n  _unbindEvents() {\n    this.$options.off('change.variant-helper');\n  }\n\n  _switchVariant(event, firstLoad = false) {\n    const options = [];\n    const $selected = event ? $(event.target) : null;\n    let variant = null;\n    let availableOptions = null;\n\n    if (this.optionsType === this.optionsTypes.select) {\n      this.$options.each((i, option) => {\n        options.push(option.value);\n      });\n    } else if (this.optionsType === this.optionsTypes.radio) {\n      this.$options.filter(':checked').each((i, option) => {\n        options.push(option.value);\n      });\n    } else {\n      return;\n    }\n\n    variant = this.productOptions.getVariantOrClosestFromOptions(options);\n\n    if (variant) {\n      availableOptions = this.productOptions.getAvailableOptionsFromVariant(variant);\n    } else {\n      return;\n    }\n\n    if (this.optionsType === this.optionsTypes.select) {\n      this._switchVariantSelect(variant, availableOptions);\n    } else if (this.optionsType === this.optionsTypes.radio) {\n      this._switchVariantRadio(variant, availableOptions);\n      if ($selected) {\n        $selected.focus();\n      }\n    } else {\n      return;\n    }\n\n    this.$variants.val(variant.id);\n    $(window).trigger('product-variant-switch', {\n      product: this.product,\n      variant,\n      firstLoad,\n    });\n  }\n\n  _switchVariantSelect(variant, availableOptions) {\n    // Iterate over each option type\n    for (let i = 0; i < this.product.options.length; i++) {\n      // Corresponding select dropdown\n      const $select = $(this.$options[i]);\n      const $optionEls = $select.find('option');\n\n      // Iterate over each option on dropdown\n      $optionEls.each((index, option) => {\n        const $option = $(option);\n        const { value } = option;\n\n        // Not an available option\n        $option\n          .prop('disabled', (!availableOptions[i][value] || !availableOptions[i][value].available))\n          .prop('selected', false);\n\n        // Dropdown option matches variant option\n        if (variant.options[i] === value) {\n          $option\n            .prop('disabled', false)\n            .prop('selected', true);\n        }\n      });\n    }\n  }\n\n  _switchVariantRadio(variant, availableOptions) {\n    this.$options\n      .attr('disabled', true)\n      .prop('checked', false)\n      .attr('data-soldout', false);\n\n    for (let i = 0; i < this.product.options.length; i++) {\n      const selector = encodeURIComponent(this.product.options[i])\n        .replace(/%20/g, '+')\n        .replace(/[!'()*]/g, char => `%${char.charCodeAt(0).toString(16).toUpperCase()}`);\n\n      const $options = this.$options.filter(`[name=\"${selector}\"]`);\n      $options.each((index, option) => {\n        const $option = $(option);\n\n        if (variant.options[i] === $option.val()) {\n          $option\n            .prop('checked', true);\n        }\n\n        if (availableOptions[i][$option.val()]) {\n          $option.attr('disabled', false);\n\n          if (!availableOptions[i][$option.val()].available) {\n            $option.attr('disabled', true);\n            $option.attr('data-soldout', true);\n          }\n        }\n      });\n    }\n  }\n\n  isDefault() {\n    if (this.product.variants[0].title === 'Default Title' && this.product.variants[0].option1 === 'Default Title') {\n      return true;\n    }\n\n    return false;\n  }\n\n  hasSingleOption() {\n    return this.optionsCount === 1;\n  }\n\n  getSelectedVariant() {\n    const options = [];\n\n    if (this.optionsType === this.optionsTypes.select) {\n      this.$options.each((i, option) => {\n        options.push(option.value);\n      });\n    } else if (this.optionsType === this.optionsTypes.radio) {\n      this.$options.filter(':checked').each((i, option) => {\n        options.push(option.value);\n      });\n    } else {\n      return null;\n    }\n\n    return this.productOptions.getVariantFromOptions(options);\n  }\n\n  unload() {\n    this._unbindEvents();\n  }\n}\n","\n/**\n * Determines if flickity needs to be resized based on the selected image height\n *\n * @param {object} flickity - the flickity instance\n */\nexport default function resizeFlickityIfNeeded(flickity) {\n  if (!flickity) {\n    return;\n  }\n\n  const activeHeight = flickity.selectedElement.offsetHeight;\n  const flickityHeight = flickity.viewport.offsetHeight;\n\n  // If flickity height is greater than slide height, ignore\n  if (activeHeight < flickityHeight) {\n    return;\n  }\n\n  flickity.resize();\n}\n","import $ from 'jquery';\nimport Pixelzoom from 'pixelzoom';\nimport layout from '../Layout';\n\nexport default class ProductZoom {\n  constructor(options) {\n    this.$gallery = options.$gallery;\n    this.settings = options.settings;\n    this.$slider = this.$gallery.find('[data-product-slider]');\n\n    this.$pixelzoomOverlay = this.$gallery.find('[data-pixelzoom-overlay]');\n    this.$pixelzoomOverlayContainer = this.$pixelzoomOverlay.find('[data-pixelzoom-overlay-container]');\n\n    this.imageZoom = {};\n    this.zoomOverlay = null;\n    this.index = 0;\n\n    this._beforeOpen = this._beforeOpen.bind(this);\n    this._onOpen = this._onOpen.bind(this);\n    this._onClose = this._onClose.bind(this);\n\n    this._showZoomInstructions = this._showZoomInstructions.bind(this);\n\n    this.modalOpen = false;\n    this.swipping = false;\n    this.touched = false;\n\n    this._bindEvents();\n    this.enableZoom();\n  }\n\n  unload() {\n    if (Object.keys(this.imageZoom).length !== 0) {\n      Object.keys(this.imageZoom).forEach(image => {\n        this.imageZoom[image].unload();\n      });\n\n      this.imageZoom = {};\n    }\n\n    if (this.zoomOverlay) {\n      this.zoomOverlay.unload();\n      this.zoomOverlay = null;\n    }\n\n    document.body.removeEventListener('touchmove', event => {\n      event.preventDefault();\n    }, { passive: false });\n\n    this.$pixelzoomOverlayContainer.off('pixelzoom:pan');\n    this.$pixelzoomOverlayContainer.off('pixelzoom:release');\n\n    this.$slider.off('.product-zoom');\n  }\n\n  enableZoom(index) {\n    if (layout.isBreakpoint('XS')) {\n      this.unload();\n      return;\n    }\n\n    if ((index !== -1 && index) || index === 0) {\n      this.index = index;\n    }\n\n    const $newSlide = this.$slider.find(`[data-product-image-index=${this.index}] .product-galley--image-background`);\n    const inObject = !this.imageZoom[this.index];\n    const slideExists = this.$gallery.find(`[data-product-image-index=${this.index}][data-product-image-zoom]`).length;\n\n    if (inObject && slideExists) {\n      this.imageZoom[this.index] = new Pixelzoom($newSlide[0], {\n        imageSource: $newSlide[0].dataset.image,\n        initialZoom: this.settings.image_zoom_level === 'min' ? 1 : 9999,\n        zoomSensitivity: 10,\n        maxZoom: 9999,\n        zoomSteps: 9999,\n        naturalPan: true,\n      });\n\n      $newSlide.on('pixelzoom:loaded', () => {\n        this._showZoomInstructions($newSlide);\n\n        $(window).on('resize', () => {\n          this._showZoomInstructions($newSlide);\n        });\n      });\n\n      $newSlide.on('pixelzoom:touch', () => {\n        const imageWidth = $newSlide.find('.pixelzoom--image').get(0).naturalWidth;\n        const imageHeight = $newSlide.find('.pixelzoom--image').get(0).naturalHeight;\n\n        if (!layout.isBreakpoint('XS') && (imageWidth / $newSlide.width() >= 2 || imageHeight / $newSlide.height() >= 2)) {\n          this._toggleClass($('body'), 'pixelzoom--active');\n        }\n\n        this.touched = true;\n      });\n\n      $newSlide.on('pixelzoom:release', () => {\n        this._toggleClass($('body'), 'pixelzoom--active', true);\n        this.touched = false;\n      });\n    }\n  }\n\n  _showZoomInstructions($newSlide) {\n    setTimeout(() => {\n      if ($newSlide.css('cursor') !== 'default') {\n        $newSlide.find('.product-galley--zoom-instructions').css('display', 'block');\n      }\n    }, 200);\n  }\n\n  _bindEvents() {\n    this.$slider.on('dragStart.flickity', () => {\n      this._preventClick();\n    });\n\n    this.$slider.on('settle.flickity', () => {\n      this._resolveClick();\n    });\n\n    document.body.addEventListener('touchmove', event => {\n      this._preventScroll(event);\n    }, { passive: false });\n  }\n\n  _toggleClass(element, className, remove) {\n    if (remove) {\n      element.removeClass(className);\n    } else {\n      element.addClass(className);\n    }\n  }\n\n  _beforeOpen() {\n    const $newSlide = this.$slider.find(`[data-product-image-index=${this.index}] .product-galley--image-background`);\n\n    this.$pixelzoomOverlayContainer.find('[data-rimg]').replaceWith($newSlide.find('[data-rimg]').clone());\n  }\n\n  _onOpen() {\n    const $newSlide = this.$slider.find(`[data-product-image-index=${this.index}] .product-galley--image-background`);\n    this.modalOpen = true;\n\n    setTimeout(() => {\n      this.zoomOverlay = new Pixelzoom(document.querySelector('[data-modal-content]'), {\n        imageSource: $newSlide[0].dataset.image,\n        naturalPan: true,\n        dragPan: true,\n        initialZoom: this.settings.image_zoom_level === 'min' ? 1 : 9999,\n        maxZoom: 9999,\n        zoomSensitivity: 10,\n        zoomSteps: 9999,\n        overflowContainer: document.querySelector('.modal--pixelzoom'),\n      });\n\n      $('[data-modal-content]').on('pixelzoom:loaded', () => {\n        $('[data-modal-content]').addClass('loaded');\n      });\n\n      $('[data-modal-content]').on('pixelzoom:touch', () => {\n        this._toggleClass($('body'), 'pixelzoom--active');\n      });\n\n      $('[data-modal-content]').on('pixelzoom:release', () => {\n        this._toggleClass($('body'), 'pixelzoom--active', true);\n      });\n    }, 500);\n  }\n\n  _onClose() {\n    $('[data-modal-content]').removeClass('loaded');\n\n    this.zoomOverlay.unload();\n    this.zoomOverlay = null;\n    this.modalOpen = false;\n  }\n\n  _preventScroll(event) {\n    if (this.modalOpen || (this.touched && !layout.isBreakpoint('XS'))) {\n      event.preventDefault();\n    }\n  }\n\n  _preventClick() {\n    this.swipping = true;\n  }\n\n  _resolveClick() {\n    this.swipping = false;\n  }\n}\n","import $ from 'jquery';\nimport Flickity from 'flickity';\nimport layout from '../Layout';\nimport scrollLeft from '../helpers/scrollLeft';\nimport resizeFlickityIfNeeded from '../helpers/flickityHelper';\nimport Video from './Video';\nimport ProductZoom from './ProductZoom';\n\nexport default class ProductGallery {\n  constructor(options) {\n    this.$gallery = options.$gallery;\n    this.settings = options.settings;\n    this.isQuickshop = options.isQuickshop || false;\n\n    // Gallery\n    this.flickity = null;\n    this.slider = '[data-product-slider]';\n    this.$slider = this.$gallery.find(this.slider);\n    this.slides = '[data-product-image]';\n    this.$slides = this.$gallery.find(this.slides);\n    this.$sliderPagination = this.$gallery.find('[data-product-slider-pagination]');\n    this.$paginationTrigger = this.$gallery.find('[data-product-thumbnail]');\n    this.productZoom = null;\n\n    if (this.settings.enable_image_zoom) {\n      this.productZoom = new ProductZoom(options);\n    }\n\n    this.videos = {};\n    this.videoSlides = this.$slider[0].querySelectorAll('[data-product-image-video]');\n\n    // Re-initialise gallery when crossing breakpoints if needed\n    this._onUpdateGallery = this._onUpdateGallery.bind(this);\n    layout.onBreakpointChange(this._onUpdateGallery);\n\n    this.slideImageLoaded = this._onSlideImageLoaded.bind(this);\n    this.variantChange = this._onVariantChange.bind(this);\n\n    if (this.isQuickshop) {\n      this.$gallery.trigger('theme:rimg:watch');\n    }\n\n    this._init();\n  }\n\n  unload() {\n    this.$slider[0].removeEventListener('rimg:load', this.slideImageLoaded);\n\n    if (this.productZoom) {\n      this.productZoom.unload();\n    }\n\n    if (this.isQuickshop) {\n      this.$gallery.trigger('theme:rimg:unwatch');\n    }\n\n    if (this.isQuickshop) {\n      this._onUpdateGallery();\n    }\n\n    layout.offBreakpointChange(this._onUpdateGallery);\n\n    this._unloadGallery();\n  }\n\n  _init() {\n    this.$slider[0].addEventListener('rimg:load', this.slideImageLoaded);\n\n    if (this.videoSlides.length) {\n      for (let i = 0; i < this.videoSlides.length; i += 1) {\n        const videoSlide = this.videoSlides[i];\n        const slideId = videoSlide.getAttribute('data-product-image');\n        const videoEl = videoSlide.querySelector('[data-video]');\n\n        this.videos[slideId] = new Video(videoEl);\n      }\n    }\n\n    if (this.$slides.length) {\n      this._initGallery();\n    }\n  }\n\n  /**\n   * Make sure Flickity updates viewport height when images load in\n   * @private\n   */\n  _onSlideImageLoaded() {\n    resizeFlickityIfNeeded(this.flickity);\n  }\n\n  _unloadGallery() {\n    if (this.flickity) {\n      for (let i = 0; i < this.videos.length; i += 1) {\n        this.videos[i].unload();\n      }\n\n      this.$paginationTrigger.off('.gallery');\n\n      this.flickity.destroy();\n      this.flickity = null;\n      this.$slider.find(this.slides).attr('style', '');\n    }\n  }\n\n  _onUpdateGallery() {\n    /**\n      Do not reset the gallery if we are taking an element full-screen.\n      This function is called by layout.onBreakpointChange, a side effect\n      of going full-screen with a video. If there is a full-screen element\n      just return out of this function.\n    */\n    if (document.fullscreenElement !== null) {\n      return;\n    }\n\n    this._unloadGallery();\n    this._initGallery();\n  }\n\n  /**\n   * Update gallery on variant change\n   *\n   * @param variant\n   * @property {Object} options.featured_image - Featured image information\n   * @private\n   */\n  _onVariantChange(variant) {\n    if (!variant.featured_image || !this.flickity) {\n      return;\n    }\n\n    const index = this.$slider\n      .find(`[data-product-image=${variant.featured_image.id}]`)\n      .attr('data-product-image-index');\n    this.flickity.select(index, false, false);\n  }\n\n  _initGallery() {\n    const $selectedImage = this.$slider.find('.image--selected');\n\n    // Options shared on Desktop and Mobile\n    let flickityOptions = {\n      autoPlay: 0,\n      accessibility: true,\n      adaptiveHeight: true,\n      cellAlign: 'left',\n      cellSelector: this.slides,\n      pageDots: false,\n      prevNextButtons: false,\n      wrapAround: true,\n    };\n\n    // Mobile only options\n    const optionsMobile = {\n      draggable: true,\n      friction: 0.8,\n      selectedAttraction: 0.2,\n    };\n\n    // Desktop only options\n    const optionsDesktop = {\n      draggable: false,\n    };\n\n    if (layout.isBreakpoint('XS')) {\n      flickityOptions = $.extend({}, optionsMobile, flickityOptions);\n    } else {\n      flickityOptions = $.extend({}, optionsDesktop, flickityOptions);\n    }\n\n    // If a variant has an image pre-selected, start the slideshow at that image\n    // If the slideshow has been re-initalised across a break point, slideshow\n    // restarts at same slide\n    if ($selectedImage.length) {\n      const initialIndex = parseInt($selectedImage.attr('data-product-image-index'), 10);\n\n      flickityOptions = $.extend({}, { initialIndex }, flickityOptions);\n    }\n\n    this.flickity = new Flickity(this.$slider[0], flickityOptions);\n\n    this._bindGallery();\n    this._handleGalleryVideos();\n  }\n\n  _bindGallery() {\n    this.flickity.on('select', () => {\n      this._updateActiveSlide(this.flickity.selectedIndex);\n      this._handleGalleryVideos();\n    });\n\n    this.$paginationTrigger.on('click.gallery', event => {\n      event.preventDefault();\n      const $target = $(event.currentTarget);\n      this.flickity.select($target.attr('data-product-thumbnail'), false, false);\n    });\n  }\n\n  /**\n   * Handle gallery videos\n   * - Pause video if is not active slide\n   * - Play video if is active slide, and is autoplay\n   *\n   * @private\n   */\n  _handleGalleryVideos() {\n    const slideId = parseInt(this.flickity.selectedElement.getAttribute('data-product-image'), 10);\n\n    Object.keys(this.videos).forEach(key => {\n      const videoKey = parseInt(key, 10);\n\n      // Pause inactive slide videos\n      if (slideId !== videoKey) {\n        this.videos[videoKey].onPauseClick();\n      }\n\n      // Play video if is selected, and auto play enabled\n      if (slideId === videoKey && this.settings.enable_video_autoplay) {\n        this.videos[videoKey].autoplay();\n      }\n    });\n  }\n\n  /**\n   * Adds a non-flickity active class to thumbnails, and main slideshow\n   *  - Is used on re-init across breakpoints\n   *  - Is used to show the active thumbnail in the pagination\n   *\n   * @param index\n   * @private\n   */\n  _updateActiveSlide(index) {\n    const $newSlide = this.$slider.find(`[data-product-image-index=${index}]`);\n    const $newThumbnail = this.$sliderPagination.find(`[data-product-thumbnail=${index}]`);\n\n    $newSlide\n      .addClass('image--selected')\n      .attr('aria-hidden', 'false')\n      .siblings('.image--selected')\n      .removeClass('image--selected')\n      .attr('aria-hidden', 'true');\n\n    $newThumbnail\n      .addClass('thumbnail--selected')\n      .siblings('.thumbnail--selected')\n      .removeClass('thumbnail--selected');\n\n    if (layout.isBreakpoint('XS')) {\n      scrollLeft($newThumbnail);\n    }\n\n    if (this.settings.enable_image_zoom) {\n      this.productZoom.enableZoom(index);\n    }\n  }\n}\n","import $ from 'jquery';\nimport CurrencyConverter from 'shopify-currency-converter';\nimport Forms from '../Forms';\nimport VariantHelper from '../VariantHelper';\nimport AddToCartFlyout from './AddToCartFlyout';\nimport ProductGallery from './ProductGallery';\n\nexport default class ProductDetails {\n  constructor(options) {\n    this.$window = $(window);\n    this.$formArea = options.$formArea;\n    this.$gallery = options.$gallery;\n    this.$details = options.$details;\n    this.context = options.context;\n    this.settings = options.settings;\n    this.product = options.product;\n    this.useHistory = options.useHistory;\n\n    this.variantHelper = null;\n\n    this.atcCallbacks = options.atcCallbacks;\n\n    // Form\n    this.$form = this.$formArea.find('[data-product-form]');\n    this.$productAtcButton = this.$formArea.find('[data-product-atc]');\n    this.$productVariants = this.$form.find('[data-variants]');\n    this.$productOptions = this.$form.find('[data-product-option]');\n\n    this.variantFields = {\n      $price: this.$details.find('[data-price]'),\n      $priceMoney: this.$details.find('[data-price] .money'),\n      $compareAtPrice: this.$details.find('[data-price-compare-at]'),\n      $compareAtPriceMoney: this.$details.find('[data-price-compare-at] .money'),\n      $badge: this.$details.find('[data-badge-sales]'),\n      $badgeMoneySaved: this.$details.find('[data-price-money-saved]'),\n      $badgePercentSaved: this.$details.find('[data-price-percent-saved]'),\n      $sku: this.$details.find('[data-product-sku]'),\n    };\n\n    this.forms = new Forms(this.$form);\n    this.gallery = new ProductGallery(options);\n\n    this._bindEvents();\n    this._initOptions();\n  }\n\n  unload() {\n    this.$form.off('.product-details');\n    this.forms.unload();\n\n    if (this.variantHelper) {\n      this.variantHelper.unload();\n    }\n\n    this.gallery.unload();\n  }\n\n  _bindEvents() {\n    this.$window.on('product-variant-switch.product-details', (event, data) => this._switchVariant(event, data));\n    this.$form.on('submit.product-details', event => this._AddToCartFlyout(event));\n  }\n\n  _initOptions() {\n    if (!this.$productVariants.length) return;\n\n    this.variantHelper = new VariantHelper(\n      this.product,\n      this.$productVariants,\n      this.$productOptions,\n    );\n  }\n\n  _switchVariant(event, data) {\n    if (data.product !== this.product) return;\n\n    const {\n      variant,\n      firstLoad,\n    } = data;\n\n    if (firstLoad) {\n      return;\n    }\n\n    // Update main select\n    this.$productVariants.val(data.variant.id);\n    this.gallery.variantChange(variant);\n\n    // Update Variant information\n    this._updatePrice(variant);\n    this._updateSKU(variant);\n    this._updateBadge(variant);\n    this._updateButton(variant);\n\n    if (this.useHistory) {\n      const url = `${this.product.handle}?${$.param({ variant: variant.id })}`;\n      history.replaceState({}, 'variant', url);\n    }\n  }\n\n  _updatePrice(variant) {\n    // Update compare at price\n    const hasComparePrice = (\n      !!variant.compare_at_price && variant.compare_at_price > variant.price\n    );\n    this.variantFields.$compareAtPrice.toggleClass('visible', hasComparePrice);\n    this.variantFields.$compareAtPriceMoney.text(\n      Shopify.formatMoney(variant.compare_at_price, this.settings.money_format),\n    );\n    CurrencyConverter.update(this.variantFields.$compareAtPriceMoney[0]);\n\n    // Update price\n    this.variantFields.$priceMoney.text(\n      Shopify.formatMoney(variant.price, this.settings.money_format),\n    );\n    CurrencyConverter.update(this.variantFields.$priceMoney[0]);\n  }\n\n  _updateSKU(variant) {\n    if (variant.sku === '') {\n      this.variantFields.$sku.parent().addClass('product-sku--empty');\n    } else {\n      this.variantFields.$sku.parent().removeClass('product-sku--empty');\n    }\n\n    this.variantFields.$sku.text(variant.sku);\n  }\n\n  _updateBadge(variant) {\n    const priceSaved = variant.compare_at_price ? variant.compare_at_price - variant.price : 0;\n    this.variantFields.$badge.toggle(!!priceSaved);\n\n    if (this.variantFields.$badgeMoneySaved.length) {\n      // Update badge if it shows money saved\n      this.variantFields.$badgeMoneySaved.text(\n        Shopify.formatMoney(priceSaved, this.settings.money_format),\n      );\n      CurrencyConverter.update(this.variantFields.$badgeMoneySaved[0]);\n    }\n\n    if (this.variantFields.$badgePercentSaved.length) {\n      // Update badge if it shows percentiles\n      const percentileSaved = Math.round((priceSaved * 100) / variant.compare_at_price);\n      this.variantFields.$badgePercentSaved.text(percentileSaved);\n    }\n  }\n\n  _updateButton(variant) {\n    if (variant.available) {\n      this.$productAtcButton.text(this.context.product_available);\n      this.$productAtcButton\n        .removeClass('disabled')\n        .prop('disabled', false);\n    } else {\n      this.$productAtcButton.text(this.context.product_unavailable);\n      this.$productAtcButton\n        .addClass('disabled')\n        .prop('disabled', true);\n    }\n  }\n\n  _AddToCartFlyout(event) {\n    event.preventDefault();\n\n    const formData = this.$form.serializeArray();\n\n    const options = {\n      $atcButton: this.$productAtcButton,\n      settings: {\n        moneyFormat: this.settings.money_format,\n        cartRedirection: this.settings.cart_redirection,\n      },\n    };\n\n    AddToCartFlyout.init(formData, options, this.atcCallbacks);\n  }\n}\n","export default class Images {\n  /**\n   * Preloads an image in memory and uses the browsers cache to store it until needed.\n   *\n   * @param {Array} images - A list of image urls\n   * @param {String} size - A shopify image size attribute\n   */\n  preload(images, size) {\n    let imageArray = images;\n    if (typeof images === 'string') {\n      imageArray = [images];\n    }\n\n    for (let i = 0; i < imageArray.length; i++) {\n      this.loadImage(this.getSizedImageUrl(imageArray[i], size));\n    }\n  }\n\n  /**\n   * Loads and caches an image in the browsers cache.\n   *\n   * @param {string} path - An image url\n   */\n  loadImage(path) {\n    const image = new Image();\n    image.src = path;\n    return image;\n  }\n\n  /**\n   * Adds a Shopify size attribute to a URL\n   *\n   * @param src\n   * @param size\n   * @returns {*}\n   */\n  getSizedImageUrl(src = null, size) {\n    if (!size) {\n      return null;\n    }\n\n    if (size === 'master') {\n      return this.removeProtocol(src);\n    }\n\n    const match = src.match(/\\.(jpg|jpeg|gif|png|bmp|bitmap|tiff|tif)(\\?v=\\d+)?$/i);\n\n    if (match) {\n      const prefix = src.split(match[0]);\n      const suffix = match[0];\n\n      return this.removeProtocol(`${prefix[0]}_${size}${suffix}`);\n    }\n\n    console.warn(`No ${size} found for '${src}`);\n    return null;\n  }\n\n  removeProtocol(path) {\n    return path.replace(/http(s)?:/, '');\n  }\n}\n","import $ from 'jquery';\nimport CurrencyConverter from 'shopify-currency-converter';\nimport {\n  trapFocus,\n  removeTrapFocus,\n} from '@shopify/theme-a11y';\n\nimport MessageBanner from './MessageBanner';\nimport Images from '../helpers/Images';\n\nclass AddToCartFlyout {\n  constructor() {\n    this.formData = {};\n    this.settings = {};\n    this.events = [];\n    this.Images = new Images();\n    this.flyOutSelector = '[data-atc-banner]';\n    this.$atcTemplate = $(`[data-templates] ${this.flyOutSelector}`);\n    this.activeElement = null;\n    this.itemId = null;\n\n    this.atcFlyOut = document.querySelector(this.flyOutSelector);\n\n    this._onInit = this._onInit.bind(this);\n    this._onError = this._onError.bind(this);\n    this._onSuccess = this._onSuccess.bind(this);\n    this._onCloseAll = this._onCloseAll.bind(this);\n    this._handleDocumentClick = this._handleDocumentClick.bind(this);\n\n    this._closeEsc = this._closeEsc.bind(this);\n\n    this.messageBanner = new MessageBanner();\n\n    this.header = document.querySelector('[data-site-header]');\n    this.headerAnnouncement = document.querySelector('[data-site-header-announcement]');\n    this.$header = $(this.header);\n    this.$body = $(document.body);\n  }\n\n  init(formData, options, callbacks = {}) {\n    this.formData = formData;\n\n    // Allows ATC Flow to be overridden\n    this.callbacks = $.extend({\n      onInit: this._onInit,\n      onError: this._onError,\n      onSuccess: this._onSuccess,\n      onClose: this._onCloseAll,\n    }, callbacks);\n\n    const { $atcButton } = options;\n\n    this.settings = $.extend({\n      moneyFormat: null,\n      cartRedirection: false,\n    }, options.settings);\n\n    // If any FlyOuts are fully open, close them\n    this._closeFlyOuts();\n\n    this.callbacks.onInit();\n\n    this.activeElement = document.activeElement;\n\n    this._disableButton($atcButton);\n    this._updateCart($atcButton);\n  }\n\n  unload() {\n    this.messageBanner.dismissBanners();\n    this._removeFlyOuts();\n    delete this.Images;\n  }\n\n  _updateCart($atcButton) {\n    const $flyOut = this.$atcTemplate.clone();\n\n    const quantityField = this.formData.filter(data => data.name === 'quantity');\n    const quantity = quantityField[0].value;\n\n    $.ajax({\n      type: 'POST',\n      url: '/cart/add.js',\n      data: $.param(this.formData),\n      dataType: 'json',\n    })\n      .done(response => {\n        this.itemId = response.id;\n\n        if (response.image) {\n          const imageUrl = this.Images.getSizedImageUrl(response.image, '200x');\n          this.Images.loadImage(imageUrl);\n\n          $flyOut.find('[data-atc-banner-product-image]')\n            .html(`<img src=\"${imageUrl}\" alt=\"${response.product_title}\">`);\n        }\n\n        $flyOut.find('[data-atc-banner-product-title]')\n          .text(response.product_title);\n\n        /*\n          TODO: Bring in `variant.options`, iterate through to get option\n            name for: <strong>Option name:</strong> Option\n        */\n        if (response.variant_options[0] !== 'Title' && response.variant_options[0] !== 'Default Title') {\n          $flyOut.find('[data-atc-banner-product-options]')\n            .text(response.variant_options.join(', '));\n        }\n\n        /*\n          TODO: Bring in variant, and use that to check compare_at_price\n            to see if the item is on sale\n        */\n        const $productPriceQuantity = $flyOut.find('[data-atc-banner-product-price-quantity]');\n        $productPriceQuantity.text(`${quantity} × `);\n\n        $.ajax({\n          type: 'GET',\n          url: '/cart.js',\n          dataType: 'json',\n        })\n          .done(secondResponse => {\n            if (this.settings.cartRedirection) {\n              location.href = '/cart';\n              return;\n            }\n\n            this.callbacks.onSuccess();\n\n            // Reset formData in case instance is never cleared\n            this.formData = {};\n\n            let lineItem = null;\n            secondResponse.items.forEach(item => {\n              if (item.id === this.itemId) {\n                if (!lineItem) {\n                  lineItem = item;\n                } else {\n                  // If there are 2 lineItems with the same id, it means that there is\n                  // likely a BOGO offer on the product. We need to grab the highest discounted\n                  // price (BOGO will be 0) while also combining with the different discounts on\n                  // the product in the discounts array.\n                  lineItem.line_level_discount_allocations = lineItem\n                    .line_level_discount_allocations.concat(item.line_level_discount_allocations);\n                  lineItem.final_price = lineItem.final_price > item.final_price\n                    ? lineItem.final_price\n                    : item.final_price;\n                  lineItem.quantity += item.quantity;\n                }\n              }\n            });\n\n            const $productPriceValue = $flyOut.find('[data-atc-banner-product-price-value]');\n            $productPriceValue.text(\n              Shopify.formatMoney(lineItem.original_price, this.settings.moneyFormat),\n            );\n\n            // Update price to local currency\n            CurrencyConverter.update($productPriceValue[0]);\n\n            const $productPriceDiscounted = $flyOut.find('[data-atc-banner-product-price-discounted]');\n            if (lineItem.final_price < lineItem.original_price) {\n              $productPriceDiscounted.text(\n                Shopify.formatMoney(lineItem.final_price, this.settings.moneyFormat),\n              );\n              // Update price to local currency\n              CurrencyConverter.update($productPriceDiscounted[0]);\n\n              $productPriceDiscounted.show();\n              $productPriceValue.addClass('original-price');\n            } else {\n              $productPriceDiscounted.hide();\n              $productPriceValue.removeClass('original-price');\n            }\n\n            const $productDiscounts = $flyOut.find('[data-atc-banner-product-discounts]');\n            if (lineItem.line_level_discount_allocations.length > 0) {\n              const discountItemTemplate = $productDiscounts.children().first();\n              $productDiscounts.empty();\n\n              lineItem.line_level_discount_allocations.forEach(discount => {\n                const $listItem = discountItemTemplate.clone();\n                $listItem.find('.discount-title').html(discount.discount_application.title);\n                const $amount = $listItem.find('.discount-amount');\n                $amount.html(discount.amount);\n                $productDiscounts.append($listItem);\n                CurrencyConverter.update($amount[0]);\n              });\n\n              $productDiscounts.show();\n            } else {\n              $productDiscounts.hide();\n            }\n\n            const $subTotal = $flyOut.find('[data-atc-banner-cart-subtotal]');\n            $subTotal.text(\n              Shopify.formatMoney(secondResponse.total_price, this.settings.moneyFormat),\n            );\n            CurrencyConverter.update($subTotal[0]);\n\n            $flyOut\n              .find('[data-atc-banner-cart-button]')\n              .find('span').text(secondResponse.item_count);\n\n            this.$header.append($flyOut);\n\n            // Notifiy Header of new cart count\n            this.$header.trigger('cartcount:update', { response: secondResponse });\n\n            this._bindEvents($flyOut);\n            this._openFlyOut($flyOut, $atcButton);\n          });\n      })\n      .fail(response => {\n        let errorText;\n        try {\n          const responseText = JSON.parse(response.responseText);\n          errorText = responseText.description;\n        } catch (error) {\n          errorText = `${response.status} ${response.statusText}`;\n          if (response.status === 401) {\n            errorText = `${errorText}. Try refreshing and logging in.`;\n          }\n        }\n\n        this._enableButton($atcButton);\n        this.callbacks.onError(errorText);\n      });\n  }\n\n  _onError(error) {\n    this.messageBanner.message(error, 'error');\n  }\n\n  _onInit() {\n    this.messageBanner.dismissBanners();\n  }\n\n  _onSuccess() {\n    /*\n      By default, the ATC Flyout doesn't need any additional success callbacks\n\n      The `this.callbacks.onSuccess` is used to allow other views to initiate\n      behaviour when a product has been added to the cart\n     */\n  }\n\n  _onCloseAll() {\n    /*\n      By default, the ATC Flyout doesn't need any additional close callbacks\n\n      The `this.callbacks.onClose` is used to allow other views to initiate\n      behaviour when the atc banner has been closed\n     */\n  }\n\n  _bindEvents($flyOut) {\n    this.events.push([\n      $flyOut.on('click.atc-banner', '[data-atc-banner-close]', event => {\n        event.preventDefault();\n        this._closeFlyOut($flyOut);\n      }),\n      $(document).on('touchstart.atc-banner, click.atc-banner', this._handleDocumentClick),\n    ]);\n  }\n\n  /**\n   * Trigger any existing open FlyOuts to close\n   *\n   * @private\n   */\n  _closeFlyOuts($excludeFlyOut = null) {\n    $(this.flyOutSelector).filter('[data-flyout-active]').each((index, el) => {\n      const $flyOut = $(el);\n\n      if ($excludeFlyOut && $flyOut.is($excludeFlyOut)) {\n        return;\n      }\n\n      this._closeFlyOut($flyOut, index);\n    });\n\n    if (!$excludeFlyOut) {\n      this.callbacks.onClose();\n    }\n\n    window.removeEventListener('keydown', this._closeEsc);\n  }\n\n  _openFlyOut($flyOut, $atcButton) {\n    /*\n     If user has initiated a new ATC Flow before the first has finished,\n     the first FlyOut could have opened after the first attempt to close open flyouts\n    */\n    this._closeFlyOuts($flyOut);\n\n    $flyOut\n      .addClass('animating animating-in')\n      .one('trend', () => {\n        $flyOut\n          .removeClass('animating animating-in')\n          .addClass('visible')\n          .off('trend');\n\n        $flyOut.attr('data-flyout-active', true);\n\n        trapFocus($flyOut[0]);\n\n        window.addEventListener('keydown', this._closeEsc);\n\n        this._enableButton($atcButton);\n      });\n  }\n\n  _closeEsc(e) {\n    if (e.key === 'Escape') {\n      this._closeFlyOuts();\n    }\n  }\n\n  /**\n   * Close an open FlyOut\n   *\n   * @param $flyOut\n   * @param index\n   * @private\n   */\n  _closeFlyOut($flyOut = null, index = 0) {\n    if (!$flyOut) {\n      return;\n    }\n\n    $flyOut\n      .addClass('animating animating-out')\n      .one('trend', () => {\n        $flyOut\n          .removeClass('animating animating-out visible')\n          .one('trend', () => {\n            $flyOut.off('trend');\n            this._removeFlyOut($flyOut, index);\n\n            // if the user clicked onto the search box, close the atc flyout and move focus\n            // to the search instead of going to the previous active element.\n            if (this.documentClickEventTarget && 'liveSearchInput' in this.documentClickEventTarget.dataset) {\n              this.documentClickEventTarget.focus();\n            } else if (this.activeElement) {\n              this.activeElement.focus();\n            }\n\n            removeTrapFocus($flyOut[0]);\n            this.callbacks.onClose();\n          });\n      });\n  }\n\n  _removeFlyOuts() {\n    $(this.flyOutSelector).filter('[data-flyout-active]').each((index, el) => {\n      this._removeFlyOut($(el), index);\n    });\n  }\n\n  /**\n   * Remove the Flyout from the DOM, and clean up listeners\n   *\n   * @param $flyOut\n   * @param index\n   * @private\n   */\n  _removeFlyOut($flyOut, index) {\n    if (this.events[index]) {\n      this.events[index].forEach($el => $el.off('.atc-banner'));\n      this.events.splice(index, 1);\n    }\n\n    if ($flyOut) {\n      $flyOut.remove();\n    }\n  }\n\n  _disableButton($atcButton) {\n    $atcButton\n      .addClass('processing')\n      .prop('disabled', true);\n  }\n\n  _enableButton($atcButton) {\n    $atcButton\n      .prop('disabled', false)\n      .removeClass('processing');\n  }\n\n  _handleDocumentClick(event) {\n    const { target } = event;\n    const $parent = $(target).parents('[data-atc-banner]');\n\n    if ($parent.length) {\n      return;\n    }\n\n    this.documentClickEventTarget = target;\n    this._closeFlyOuts();\n  }\n}\n\nexport default new AddToCartFlyout();\n"],"sourceRoot":""}